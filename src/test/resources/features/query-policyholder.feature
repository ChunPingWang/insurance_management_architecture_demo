Feature: 查詢保戶資料 (US2)
  作為客服/業務人員
  我可以透過保戶編號、身分證字號查詢保戶
  支援姓名模糊搜尋與分頁

  Background:
    Given 系統已啟動
    And 已存在以下保戶資料:
      | 保戶編號       | 身分證字號   | 姓名   | 狀態   |
      | PH0000000001 | A123456789 | 王小明 | ACTIVE |
      | PH0000000002 | F131104093 | 王大華 | ACTIVE |
      | PH0000000003 | A234567890 | 李小美 | ACTIVE |

  @smoke @us2
  Scenario: 根據保戶編號查詢
    When 我查詢保戶編號 "PH0000000001"
    Then 系統回傳 200 狀態碼
    And 回傳資料的保戶編號為 "PH0000000001"
    And 回傳資料的姓名為 "王小明"

  @us2
  Scenario: 根據身分證字號查詢
    When 我根據身分證字號 "A123456789" 查詢保戶
    Then 系統回傳 200 狀態碼
    And 回傳資料的身分證字號為 "A123456789"

  @us2
  Scenario: 保戶編號不存在時回傳 404
    When 我查詢保戶編號 "PH9999999999"
    Then 系統回傳 404 狀態碼
    And 錯誤訊息包含 "not found"

  @us2
  Scenario: 身分證字號不存在時回傳 404
    When 我根據身分證字號 "Z999999999" 查詢保戶
    Then 系統回傳 404 狀態碼

  @us2
  Scenario: 姓名模糊搜尋
    When 我搜尋姓名包含 "王" 的保戶
    Then 系統回傳 200 狀態碼
    And 回傳資料包含 2 筆保戶
    And 回傳資料的姓名都包含 "王"

  @us2
  Scenario: 姓名搜尋無結果
    When 我搜尋姓名包含 "陳" 的保戶
    Then 系統回傳 200 狀態碼
    And 回傳資料為空列表

  @us2
  Scenario: 分頁查詢 - 第一頁
    Given 已存在 25 筆保戶資料
    When 我查詢保戶列表，每頁 10 筆，第 0 頁
    Then 系統回傳 200 狀態碼
    And 回傳資料包含 10 筆保戶
    And 分頁資訊顯示總筆數為 25
    And 分頁資訊顯示目前為第一頁

  @us2
  Scenario: 分頁查詢 - 最後一頁
    Given 已存在 25 筆保戶資料
    When 我查詢保戶列表，每頁 10 筆，第 2 頁
    Then 系統回傳 200 狀態碼
    And 回傳資料包含 5 筆保戶
    And 分頁資訊顯示為最後一頁

  @us2
  Scenario: 預設分頁參數
    When 我查詢保戶列表不帶分頁參數
    Then 系統回傳 200 狀態碼
    And 分頁資訊顯示 page=0, size=20
